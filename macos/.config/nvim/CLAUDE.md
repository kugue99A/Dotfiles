# CLAUDE.md

このファイルは、このリポジトリでコードを扱う際のClaude Code (claude.ai/code) へのガイダンスを提供します。

## コマンド

### Neovimプラグイン管理
- **プラグインの更新**: Neovimを開いて `:Lazy sync` を実行
- **プラグインの状態確認**: `:Lazy`
- **プラグインロックファイルの更新**: `:Lazy update` を実行後、`lazy-lock.json` をコミット

### LSPサーバー管理
- **LSPサーバーの設定**: `lsp/` ディレクトリに個別の設定ファイルを配置
- **対応言語**: Lua, TypeScript/Deno, Go, Rust, Python
- **新しいLSPサーバーの追加**: `init.lua` の `lsp_servers` テーブルに追加し、対応する設定ファイルを `lsp/` に作成

## アーキテクチャ

これはlazy.nvimをプラグインマネージャーとして使用するモジュラーなNeovim設定です。設定は、`lua/plugins.lua`で定義されるプラグインと`lua/plugins/`配下の個別ファイルで定義されるプラグインのハイブリッドアプローチを採用しています。

### 主要コンポーネント

1. **エントリーポイント**: `init.lua` がコアオプション、キーマップを設定し、プラグインマネージャーを読み込む
2. **プラグインマネージャー**: `lua/config/lazy.lua` が自動プラグイン検出機能付きでlazy.nvimをブートストラップ
3. **プラグイン設定**: 
   - レガシースタイル: `lua/plugins.lua` にインラインでプラグイン仕様を記述
   - モジュラースタイル: `lua/plugins/*.lua` ファイルが個別のプラグイン設定を返す
4. **LSPセットアップ**: `vim.lsp.enable` を使用してLSPサーバーを直接管理、個別設定ファイルで言語固有の設定を提供

### 重要なパターン

- **遅延読み込み**: ほとんどのプラグインはイベントベースの読み込みを使用（例: `event = "LspAttach"`）
- **LSP設定**: 言語サーバーは`lua/plugins/nvim-lspconfig.lua`でサーバー固有の設定とともに設定される
- **フォーマット**: Conform.nvimが保存時の自動フォーマット機能付きでコードフォーマットを処理
- **ファイルエクスプローラー**: 従来のサイドバーではなくVFiler（フローティングウィンドウ）を使用

### 新機能の追加

プラグインを追加する場合:
1. `lua/plugins/`にプラグイン仕様テーブルを返す新しいファイルを作成
2. `dependencies`、`config`、適切な遅延読み込みキー（`event`、`cmd`、`keys`）を含める
3. 一貫性のため既存のパターンに従う（類似プラグインを確認）

LSPサーバーを設定する場合:
1. システムにLSPサーバーをインストール（brew, cargo, npm等）
2. `lsp/server_name.lua` に設定ファイルを作成
3. `init.lua` の `lsp_servers` テーブルにサーバー名を追加
4. 適切なファイルタイプでテスト